{% extends "index.html" %}
{% load static %}
{% block content %}

<div class="phone-reset-widget">
<div class="pr-card">
<h2 class="pr-title">بازیابی رمز با شماره موبایل</h2>
<p class="pr-sub">شماره‌ت رو وارد کن؛ اگه ثبت شده باشه می‌تونی رمز جدید بذاری.</p>

{% if messages %}
<div class="pr-messages">
{% for msg in messages %}
<div class="pr-msg {{ msg.tags }}">{{ msg }}</div>
{% endfor %}
</div>
{% endif %}

<form method="post" class="pr-form" novalidate>
{% csrf_token %}
<label class="pr-label">شماره موبایل</label>
<input class="pr-input" type="text" name="phone_number" placeholder="09xx xxx xxxx" required>

<label class="pr-label">رمز جدید</label>
<div class="pr-pass-row">
<input class="pr-input pr-pass" type="password" name="new_password" placeholder="رمز جدید" required>
<button type="button" class="pr-toggle" aria-label="نمایش/پنهان کردن رمز">👁</button>
</div>

<label class="pr-label">تکرار رمز جدید</label>
<input class="pr-input" type="password" name="confirm_password" placeholder="تکرار رمز جدید" required>

<button class="pr-btn" type="submit">تغییر رمز</button>
</form>

<p class="pr-note">
<a href="{% url 'user_login' %}">بازگشت به صفحه ورود</a>
</p>
</div>
</div>

<style>
/* همه استایل‌ها فقط در داخل .phone-reset-widget اعمال می‌شوند */
.phone-reset-widget {
display: flex;
justify-content: center;
padding: 140px 16px;
box-sizing: border-box;
}

/* کارت سفید با سایه ملایم */
.pr-card {
width: 100%;
max-width: 460px;
background: #ffffff;
border-radius: 12px;
box-shadow: 0 6px 18px rgba(18, 38, 63, 0.08);
padding: 28px;
box-sizing: border-box;
font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}

/* عنوان و توضیح */
.pr-title {
margin: 0 0 8px 0;
font-size: 20px;
color: #12263f;
font-weight: 600;
text-align: center;
}
.pr-sub {
margin: 0 0 18px 0;
font-size: 13px;
color: #6b7280;
text-align: center;
}

/* پیام‌ها */
.pr-messages { margin-bottom: 12px; }
.pr-msg {
padding: 8px 10px;
border-radius: 8px;
font-size: 13px;
margin-bottom: 8px;
}
.pr-msg.error, .pr-msg.error strong { background: #fff1f0; color: #b91c1c; }
.pr-msg.success { background: #f0fdf4; color: #065f46; }

/* فرم */
.pr-form { display: grid; gap: 12px; }
.pr-label { font-size: 13px; color: #374151; margin-bottom: 6px; display: block; }
.pr-input {
width: 100%;
padding: 10px 12px;
border: 1px solid #e6e9ee;
border-radius: 8px;
font-size: 14px;
box-sizing: border-box;
outline: none;
}
.pr-input:focus { border-color:rgb(237, 94, 58); box-shadow: 0 0 0 4px rgba(124,58,237,0.06); }

/* سطر پسورد با دکمه نمایش */
.pr-pass-row { display:flex; gap:8px; align-items:center; }
.pr-pass { flex:1; }
.pr-toggle {
background: #f3f4f6;
border: 1px solid #e6e9ee;
border-radius: 8px;
padding: 8px 10px;
cursor: pointer;
font-size: 14px;
line-height: 1;
}
.pr-toggle:active { transform: translateY(1px); }

/* دکمه اصلی */
.pr-btn {
margin-top: 6px;
width: 100%;
padding: 10px 14px;
background: linear-gradient(90deg,#5b21b6,#7c3aed);
color: #fff;
border: none;
border-radius: 10px;
font-size: 15px;
cursor: pointer;
}
.pr-btn:hover { opacity: 0.95; }

/* لینک و نوت */
.pr-note {
margin-top: 12px;
text-align: center;
font-size: 13px;
color:#6b7280;
}
.pr-note a { color:#4f46e5; text-decoration:none; }
.pr-note a:hover { text-decoration:underline; }

/* واکنش‌پذیری */
@media (max-width:480px){
.pr-card { padding: 20px; border-radius:10px; }
.pr-title { font-size:18px; }
}
</style>

<script>
/* جاوااسکریپت کوچک برای نمایش/پنهان کردن رمز؛ این اسکریپت هم فقط در این تمپلیت اجرا می‌شود */
(function(){
const widget = document.querySelector('.phone-reset-widget');
if (!widget) return;

const toggle = widget.querySelector('.pr-toggle');
const pass = widget.querySelector('.pr-pass');

if (toggle && pass) {
toggle.addEventListener('click', function(){
if (pass.type === 'password') {
pass.type = 'text';
toggle.textContent = '🙈';
} else {
pass.type = 'password';
toggle.textContent = '👁';
}
});
}
})();
</script>

{% endblock %}